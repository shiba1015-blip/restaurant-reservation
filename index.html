<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ベビーフェイスプラネッツ - ご予約</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary-gold: #D4AF37;
            --dark-gold: #B8941F;
            --light-gold: #F7E98E;
            --deep-navy: #1A1B3A;
            --charcoal: #2C2C54;
            --warm-white: #FEFCF3;
            --cream: #F8F6F0;
            --soft-gray: #E8E6E1;
            --text-primary: #2C2C54;
            --text-secondary: #6B6B84;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--deep-navy) 0%, var(--charcoal) 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(212, 175, 55, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(212, 175, 55, 0.03) 0%, transparent 40%),
                radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.02) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 680px;
            margin: 60px auto;
            background: var(--warm-white);
            border-radius: 24px;
            box-shadow: 
                0 32px 64px rgba(26, 27, 58, 0.25),
                0 0 0 1px rgba(212, 175, 55, 0.1);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--dark-gold) 100%);
            padding: 48px 40px 40px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="0.5" fill="%23ffffff" opacity="0.05"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>') repeat;
            opacity: 0.3;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 32px;
            font-weight: 700;
            color: var(--warm-white);
            margin-bottom: 8px;
            letter-spacing: -0.5px;
            position: relative;
            animation: gentleFloat 4s ease-in-out infinite;
        }

        .subtitle {
            color: rgba(254, 252, 243, 0.9);
            font-size: 16px;
            font-weight: 300;
            letter-spacing: 2px;
            text-transform: uppercase;
            position: relative;
        }

        .form-container {
            padding: 48px 40px;
        }

        .notice-card {
            background: linear-gradient(135deg, var(--cream) 0%, var(--warm-white) 100%);
            border: 1px solid var(--soft-gray);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 40px;
            position: relative;
        }

        .notice-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-gold) 0%, var(--dark-gold) 100%);
            border-radius: 16px 16px 0 0;
        }

        .notice-title {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .notice-title i {
            color: var(--primary-gold);
        }

        .notice-list {
            list-style: none;
            space-y: 12px;
        }

        .notice-list li {
            padding-left: 24px;
            position: relative;
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .notice-list li::before {
            content: '✦';
            position: absolute;
            left: 0;
            color: var(--primary-gold);
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 32px;
            position: relative;
        }

        .form-group.half {
            width: 48%;
            display: inline-block;
            margin-right: 4%;
        }

        .form-group.half:last-child {
            margin-right: 0;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 12px;
            font-size: 15px;
            letter-spacing: 0.3px;
        }

        .required {
            color: var(--primary-gold);
            margin-left: 4px;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--soft-gray);
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            background: var(--warm-white);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--text-primary);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-gold);
            box-shadow: 
                0 0 0 4px rgba(212, 175, 55, 0.1),
                0 8px 24px rgba(212, 175, 55, 0.15);
            transform: translateY(-2px);
        }

        .people-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .time-slots-container {
            margin-top: 16px;
        }

        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
        }

        .time-slot {
            padding: 16px 12px;
            border: 2px solid var(--soft-gray);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            background: var(--warm-white);
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            color: var(--text-primary);
        }

        .time-slot:hover {
            border-color: var(--primary-gold);
            background: rgba(212, 175, 55, 0.05);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.15);
        }

        .time-slot.selected {
            border-color: var(--primary-gold);
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--dark-gold) 100%);
            color: var(--warm-white);
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(212, 175, 55, 0.3);
        }

        .checkbox-section {
            background: var(--cream);
            border-radius: 16px;
            padding: 32px;
            margin: 40px 0;
            border: 1px solid var(--soft-gray);
        }

        .checkbox-title {
            font-family: 'Playfair Display', serif;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .checkbox-title i {
            color: var(--primary-gold);
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            cursor: pointer;
            font-size: 15px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .checkbox-item:last-child {
            margin-bottom: 0;
        }

        .custom-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--soft-gray);
            border-radius: 4px;
            margin-right: 16px;
            margin-top: 2px;
            position: relative;
            transition: all 0.3s;
            flex-shrink: 0;
            cursor: pointer;
        }

        .checkbox-item input[type="checkbox"] {
            display: none;
        }

        .checkbox-item input[type="checkbox"]:checked + .custom-checkbox {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--dark-gold) 100%);
            border-color: var(--primary-gold);
        }

        .checkbox-item input[type="checkbox"]:checked + .custom-checkbox::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .submit-button {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--dark-gold) 100%);
            color: var(--warm-white);
            border: none;
            padding: 20px 48px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 12px 32px rgba(212, 175, 55, 0.25);
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .submit-button:disabled {
            background: #ccc !important;
            cursor: not-allowed !important;
            transform: none !important;
        }

        .submit-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s;
        }

        .submit-button:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.35);
            background: linear-gradient(135deg, var(--dark-gold) 0%, #A17B1A 100%);
        }

        .submit-button:hover::before {
            left: 100%;
        }

        .success-message, .error-message {
            display: none;
            padding: 32px;
            border-radius: 16px;
            text-align: center;
            margin-top: 24px;
        }

        .success-message {
            background: linear-gradient(135deg, #E8F5E8 0%, #F0FAF0 100%);
            color: #2D5A2D;
            border: 2px solid #C8E6C8;
        }

        .error-message {
            background: linear-gradient(135deg, #FEE2E2 0%, #FEF2F2 100%);
            color: #DC2626;
            border: 2px solid #F87171;
        }

        .success-message h3, .error-message h3 {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--soft-gray), transparent);
            margin: 40px 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 20px;
                border-radius: 16px;
            }

            .header {
                padding: 32px 24px 24px;
            }

            .form-container {
                padding: 32px 24px;
            }

            .logo {
                font-size: 24px;
            }

            .people-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .time-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }

            .form-group.half {
                width: 100%;
                display: block;
                margin-right: 0;
            }
        }

        @keyframes gentleFloat {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-8px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <i class="fas fa-utensils"></i>
                ベビーフェイス プラネッツ
            </div>
            <div class="subtitle">Reservation System</div>
        </div>
        
        <div class="form-container">
            <div class="notice-card">
                <div class="notice-title">
                    <i class="fas fa-info-circle"></i>
                    ご予約前にご確認ください
                </div>
                <ul class="notice-list">
                    <li>9名以上・コース・プレート・マット席（座敷）をご注文の方はお電話にてお願いします</li>
                    <li>ネット予約は前々日の21時までとなります</li>
                </ul>
            </div>
            
            <form id="reservationForm">
                <div class="form-group">
                    <label class="form-label" for="email">
                        <i class="fas fa-envelope"></i>
                        メールアドレス<span class="required">*</span>
                    </label>
                    <input type="email" id="email" name="email" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="emailConfirm">
                        <i class="fas fa-envelope-open"></i>
                        メールアドレス（確認）<span class="required">*</span>
                    </label>
                    <input type="email" id="emailConfirm" name="emailConfirm" class="form-input" required>
                </div>

                <div class="divider"></div>
                
                <div class="form-group half">
                    <label class="form-label" for="name">
                        <i class="fas fa-user"></i>
                        お名前<span class="required">*</span>
                    </label>
                    <input type="text" id="name" name="name" class="form-input" required>
                </div>
                
                <div class="form-group half">
                    <label class="form-label" for="furigana">
                        <i class="fas fa-font"></i>
                        フリガナ<span class="required">*</span>
                    </label>
                    <input type="text" id="furigana" name="furigana" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="phone">
                        <i class="fas fa-phone"></i>
                        電話番号<span class="required">*</span>
                    </label>
                    <input type="tel" id="phone" name="phone" class="form-input" required>
                </div>

                <div class="divider"></div>
                
                <div class="form-group">
                    <label class="form-label" for="date">
                        <i class="fas fa-calendar-alt"></i>
                        ご希望日<span class="required">*</span>
                    </label>
                    <input type="date" id="date" name="date" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-clock"></i>
                        ご希望時間<span class="required">*</span>
                    </label>
                    <div class="time-slots-container">
                        <div class="time-grid">
                            <div class="time-slot" onclick="selectTime(this, '10:00')">10:00</div>
                            <div class="time-slot" onclick="selectTime(this, '10:30')">10:30</div>
                            <div class="time-slot" onclick="selectTime(this, '11:00')">11:00</div>
                            <div class="time-slot" onclick="selectTime(this, '11:30')">11:30</div>
                            <div class="time-slot" onclick="selectTime(this, '12:00')">12:00</div>
                            <div class="time-slot" onclick="selectTime(this, '12:30')">12:30</div>
                            <div class="time-slot" onclick="selectTime(this, '13:00')">13:00</div>
                            <div class="time-slot" onclick="selectTime(this, '13:30')">13:30</div>
                            <div class="time-slot" onclick="selectTime(this, '14:00')">14:00</div>
                            <div class="time-slot" onclick="selectTime(this, '14:30')">14:30</div>
                            <div class="time-slot" onclick="selectTime(this, '15:00')">15:00</div>
                            <div class="time-slot" onclick="selectTime(this, '15:30')">15:30</div>
                            <div class="time-slot" onclick="selectTime(this, '16:00')">16:00</div>
                            <div class="time-slot" onclick="selectTime(this, '16:30')">16:30</div>
                            <div class="time-slot" onclick="selectTime(this, '17:00')">17:00</div>
                            <div class="time-slot" onclick="selectTime(this, '17:30')">17:30</div>
                            <div class="time-slot" onclick="selectTime(this, '18:00')">18:00</div>
                            <div class="time-slot" onclick="selectTime(this, '18:30')">18:30</div>
                            <div class="time-slot" onclick="selectTime(this, '19:00')">19:00</div>
                            <div class="time-slot" onclick="selectTime(this, '19:30')">19:30</div>
                            <div class="time-slot" onclick="selectTime(this, '20:00')">20:00</div>
                            <div class="time-slot" onclick="selectTime(this, '20:30')">20:30</div>
                        </div>
                    </div>
                    <input type="hidden" id="selectedTime" name="selectedTime" required>
                </div>
                
                <div class="people-grid">
                    <div class="form-group">
                        <label class="form-label" for="adults">
                            <i class="fas fa-users"></i>
                            6歳以上<span class="required">*</span>
                        </label>
                        <select id="adults" name="adults" class="form-select" required>
                            <option value="">選択してください</option>
                            <option value="1">1名</option>
                            <option value="2">2名</option>
                            <option value="3">3名</option>
                            <option value="4">4名</option>
                            <option value="5">5名</option>
                            <option value="6">6名</option>
                            <option value="7">7名</option>
                            <option value="8">8名</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="children">
                            <i class="fas fa-child"></i>
                            6歳以下
                        </label>
                        <select id="children" name="children" class="form-select">
                            <option value="0">0名</option>
                            <option value="1">1名</option>
                            <option value="2">2名</option>
                            <option value="3">3名</option>
                            <option value="4">4名</option>
                            <option value="5">5名</option>
                        </select>
                    </div>
                </div>
                
                <div class="checkbox-section">
                    <div class="checkbox-title">
                        <i class="fas fa-clipboard-check"></i>
                        ご予約に関する注意事項（必ずご確認ください）
                    </div>
                    
                    <label class="checkbox-item">
                        <input type="checkbox" id="check1" required>
                        <div class="custom-checkbox"></div>
                        テーブルタイプのお席のみご予約可能であることを理解しました（マット席（座敷）をご希望の方は電話にてお願いいたします）
                    </label>
                    
                    <label class="checkbox-item">
                        <input type="checkbox" id="check2" required>
                        <div class="custom-checkbox"></div>
                        予約時間から30分過ぎると予約が解除されることを理解しました
                    </label>
                    
                    <label class="checkbox-item">
                        <input type="checkbox" id="check3" required>
                        <div class="custom-checkbox"></div>
                        駐車場が狭いため、なるべく乗り合わせで来店します
                    </label>
                </div>
                
                <button type="submit" class="submit-button" id="submitButton">
                    <i class="fas fa-calendar-check"></i>
                    予約を確定する
                </button>
            </form>
            
            <div id="successMessage" class="success-message">
                <h3>
                    <i class="fas fa-check-circle"></i>
                    ご予約ありがとうございます！
                </h3>
                <p>ご予約を承りました。ご不明な点がございましたらお電話にてお問い合わせください。</p>
            </div>

            <div id="errorMessage" class="error-message">
                <h3>
                    <i class="fas fa-exclamation-triangle"></i>
                    予約の送信に失敗しました
                </h3>
                <p id="errorText">申し訳ございません。しばらく時間をおいて再度お試しいただくか、お電話にてお問い合わせください。</p>
            </div>
        </div>
    </div>

    <script>
        // !!重要!! 以下を実際のSupabase設定値に置き換えてください
        const SUPABASE_URL = 'https://dulcjbgrgiwxtfgxumko.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR1bGNqYmdyZ2l3eHRmZ3h1bWtvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5NjM1NjUsImV4cCI6MjA3MTUzOTU2NX0.8AWwBsjOeWHJ0HCKrnx2Uq-JMSkWZCiIa6dQ97P3hC4';
        
        // Supabaseクライアント初期化
        const { createClient } = supabase;
        const _supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // 時間選択関数
        function selectTime(element, time) {
            // 既存の選択をクリア
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            
            // 新しい選択を追加
            element.classList.add('selected');
            document.getElementById('selectedTime').value = time;
        }
        
        // 日付の最小値を設定（明後日から）
        function setMinDate() {
            const today = new Date();
            const dayAfterTomorrow = new Date(today);
            dayAfterTomorrow.setDate(today.getDate() + 2);
            
            const dateInput = document.getElementById('date');
            dateInput.min = dayAfterTomorrow.toISOString().split('T')[0];
        }
        
        // フォーム送信処理
        document.getElementById('reservationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitButton = document.getElementById('submitButton');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            
            // メッセージを隠す
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            // ボタンを無効化
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 送信中...';
            
            try {
                // バリデーション
                const email = document.getElementById('email').value;
                const emailConfirm = document.getElementById('emailConfirm').value;
                
                if (email !== emailConfirm) {
                    throw new Error('メールアドレスが一致しません。もう一度ご確認ください。');
                }
                
                const adults = parseInt(document.getElementById('adults').value) || 0;
                const children = parseInt(document.getElementById('children').value) || 0;
                const totalPeople = adults + children;
                
                if (totalPeople >= 9) {
                    throw new Error('9名以上のご予約はお電話にてお願いします。');
                }
                
                if (!document.getElementById('selectedTime').value) {
                    throw new Error('ご希望時間を選択してください。');
                }
                
                // チェックボックス確認
                const checks = ['check1', 'check2', 'check3'];
                for (let checkId of checks) {
                    if (!document.getElementById(checkId).checked) {
                        throw new Error('すべての注意事項にご同意いただく必要があります。');
                    }
                }
                
                // Supabaseにデータを送信
                const { data, error } = await _supabase
                    .from('reservations')
                    .insert({
                        email: email,
                        email_confirm: emailConfirm,
                        name: document.getElementById('name').value,
                        furigana: document.getElementById('furigana').value,
                        phone: document.getElementById('phone').value,
                        reservation_date: document.getElementById('date').value,
                        reservation_time: document.getElementById('selectedTime').value,
                        adults: adults,
                        children: children,
                        status: 'confirmed'
                    });
                
                if (error) {
                    throw error;
                }
                
                // 成功時の処理（アニメーション付き）
                const form = document.getElementById('reservationForm');
                
                // フォームをフェードアウト
                form.style.transition = 'opacity 0.5s ease-out, transform 0.5s ease-out';
                form.style.opacity = '0';
                form.style.transform = 'translateY(-20px)';
                
                setTimeout(() => {
                    form.style.display = 'none';
                    successMessage
